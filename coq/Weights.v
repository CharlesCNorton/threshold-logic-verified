(** Trained weights - auto-generated by export_coq.py *)

Require Import Coq.ZArith.ZArith.
Require Import Coq.Lists.List.
Require Import TLV.ThresholdLogic.
Import ListNotations.
Open Scope Z_scope.

Definition layer1_weights : list (list weight * bias) :=
  [    ([0; (-1); (-1); 0; 0; (-1); (-1); 0], 0);
       ([1; (-1); (-1); (-1); (-1); 0; 1; 1], (-6));
       ([1; 0; 0; 0; 1; 1; (-1); 1], (-7));
       ([1; (-1); 1; (-1); 1; 1; 1; 1], 0);
       ([0; (-1); 1; 0; (-1); 1; 0; 1], (-6));
       ([1; (-1); 0; (-1); 1; 1; 0; 1], (-8));
       ([(-1); 1; 0; (-1); (-1); 0; 1; (-1)], 1);
       ([(-1); 1; (-1); 1; 1; (-1); (-1); (-1)], 1);
       ([(-1); 0; 1; 1; 1; 1; 1; (-1)], (-4));
       ([(-1); (-1); (-1); (-1); (-1); (-1); (-1); 1], 2);
       ([0; (-1); (-1); 1; 1; 0; 0; 0], 6);
       ([0; 1; (-1); (-1); (-1); 0; 1; 0], 5);
       ([1; (-1); (-1); 0; (-1); 1; (-1); 0], 7);
       ([1; (-1); (-1); (-1); 0; 1; 0; 0], 2);
       ([(-1); (-1); 0; 1; (-1); 1; (-1); 1], (-7));
       ([0; 0; (-1); (-1); 1; (-1); 0; 1], (-4));
       ([(-1); 1; (-1); 1; (-1); (-1); (-1); (-1)], 0);
       ([(-1); 1; (-1); 1; 1; (-1); (-1); (-1)], 3);
       ([(-1); (-1); 0; (-1); 1; 0; 0; (-1)], 6);
       ([(-1); 0; 0; 0; 0; 0; 0; 0], (-7));
       ([1; (-1); 1; (-1); 1; 1; 1; 1], (-2));
       ([(-1); 0; 1; 1; 0; (-1); (-1); 1], (-8));
       ([0; 1; 0; 0; 1; 0; 0; 1], (-1));
       ([1; 0; 1; 1; 1; 1; (-1); (-1)], (-8));
       ([1; 1; (-1); 1; 1; 1; 1; (-1)], (-2));
       ([0; (-1); (-1); 0; 0; (-1); (-1); 0], (-5));
       ([(-1); (-1); 0; 1; 0; (-1); (-1); (-1)], (-8));
       ([(-1); 1; (-1); 1; 1; (-1); (-1); (-1)], 0);
       ([(-1); 1; (-1); 1; 1; (-1); (-1); (-1)], 2);
       ([(-1); (-1); 0; (-1); (-1); 0; 0; 0], (-3));
       ([0; 1; (-1); (-1); 1; 1; 0; 1], 1);
       ([1; 1; 0; 1; 0; (-1); 0; 1], 1)].

Definition layer2_weights : list (list weight * bias) :=
  [    ([0; 1; 1; (-1); 0; 1; (-1); (-1); 1; (-1); 1; (-1); 1; 0; 1; 0; 0; 0; (-1); (-1); (-1); 0; 0; 0; 1; 1; 0; 0; 0; 0; (-1); 1], (-10));
       ([0; 1; 0; (-1); 0; 1; (-1); (-1); 1; (-1); (-1); (-1); 0; (-1); 1; 1; 1; (-1); (-1); 1; (-1); 0; (-1); 0; 1; 0; 1; 1; 0; 1; 1; 0], (-18));
       ([1; 0; 0; 0; 0; 1; 1; 1; 1; 0; 1; 0; 0; 0; (-1); (-1); 0; (-1); 0; (-1); (-1); 0; 0; (-1); 1; (-1); 0; 1; 1; 1; 0; 0], (-25));
       ([0; 0; 1; (-1); 0; (-1); 0; 1; 0; 0; 0; 1; 1; 0; 1; (-1); 1; 1; (-1); 1; 1; (-1); (-1); 0; 1; 1; 1; 1; 0; 0; 1; (-1)], (-18));
       ([1; 0; (-1); 0; (-1); 1; (-1); 1; 1; 0; 0; 0; 1; (-1); 0; 0; 0; 0; 0; (-1); 1; 1; (-1); 1; 1; 0; 0; 0; (-1); 1; (-1); 1], 5);
       ([(-1); 1; 0; 1; 0; (-1); 0; 1; (-1); 1; 0; 0; (-1); 1; (-1); 0; 1; 0; (-1); 0; 1; 1; (-1); (-1); (-1); (-1); 0; 0; 1; 1; 0; 0], (-4));
       ([0; (-1); 0; 0; (-1); (-1); 1; (-1); 1; (-1); 0; 1; (-1); 1; (-1); (-1); (-1); (-1); 0; 1; 1; (-1); (-1); 1; (-1); 1; 0; 0; (-1); (-1); 1; 0], (-25));
       ([(-1); 1; (-1); 0; 1; 1; 1; 1; 0; (-1); 0; 0; 0; 1; 1; 1; 0; (-1); (-1); 0; (-1); 1; 0; 0; 0; 1; 1; (-1); 0; (-1); 1; (-1)], 17);
       ([0; 1; (-1); 0; 0; 1; (-1); 0; 0; (-1); (-1); (-1); 0; (-1); (-1); 1; 0; (-1); 1; (-1); 1; 1; 0; (-1); (-1); (-1); 0; 1; (-1); 1; 1; 0], 30);
       ([0; 1; 0; 1; (-1); 1; (-1); 0; (-1); 0; 0; 1; 1; 0; (-1); 0; 1; 1; (-1); 1; 1; (-1); (-1); 1; 1; (-1); (-1); 0; 0; (-1); 1; 1], (-19));
       ([(-1); 0; 0; 0; 0; 0; (-1); 1; 0; 1; (-1); 1; (-1); (-1); (-1); 1; 1; (-1); (-1); 0; (-1); 0; 1; 1; (-1); 0; (-1); 0; (-1); 0; (-1); (-1)], (-28));
       ([0; (-1); (-1); 1; 1; (-1); 0; (-1); 0; 1; 0; 1; (-1); 0; 1; (-1); 1; (-1); 0; 0; 1; 1; 0; (-1); 1; (-1); (-1); 1; 1; (-1); 0; 0], (-3));
       ([(-1); (-1); 0; 1; 1; 1; 1; (-1); (-1); 0; (-1); 0; 1; 1; 1; (-1); 0; 0; (-1); 1; 0; 1; 1; 0; 1; (-1); 0; 1; 1; 0; (-1); 1], 2);
       ([(-1); 1; 0; 0; 0; 0; 1; 1; 1; (-1); 1; 0; 1; 0; 0; (-1); (-1); 1; 0; 1; 0; 0; (-1); 0; (-1); 1; (-1); 0; 1; 0; 0; (-1)], (-32));
       ([(-1); 1; 0; 1; (-1); 0; 0; 0; 0; 0; (-1); 0; 0; 1; 1; 1; 1; 0; (-1); 0; 0; 0; 0; (-1); 0; 0; 0; 0; 1; 1; (-1); 1], 20);
       ([(-1); (-1); 0; (-1); 1; (-1); 0; 1; 0; (-1); (-1); (-1); 0; 0; 1; 0; 0; 1; (-1); 1; (-1); 1; 0; 0; 1; 0; 1; (-1); 0; 0; (-1); 0], (-4))].

Definition output_weights : list weight * bias :=
  ([1; (-1); 1; 0; 0; 0; 0; 0; 1; (-1); 0; (-1); 0; 0; 1; 1], (-2)).

(** Verify with: vm_compute. reflexivity. *)
Lemma weights_valid :
  check_all_8bit layer1_weights layer2_weights output_weights = true.
Proof. vm_compute. reflexivity. Qed.

Theorem network_verified :
  forall xs, In xs (all_inputs 8) -> network xs = parity xs.
Proof.
  apply network8_correct.
  exact weights_valid.
Qed.
